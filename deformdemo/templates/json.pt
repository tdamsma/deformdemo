<tal:def tal:define="oid oid|field.oid;
                     uuid uuid|field.uuid; 
                     name name|field.name;
                     errormsg errormsg|field.errormsg;
                     jsonschema jsonschema|field.widget.jsonschema;" i18n:domain="deform">
    <input id="${oid}-${uuid}" name="${name}" value="${cstruct}" hidden></input>
    <div id="${oid}-${uuid}-editor"></div>
    <div tal:condition="errormsg" class="clearfix alert alert-danger">
        <p>${errormsg}</p>
    </div>
    <script>
        (function(){
        const container = document.getElementById("${oid}-${uuid}-editor");
        const field = document.getElementById("${oid}-${uuid}");
        const options = {
            schema: ${jsonschema},
            mode: 'code',
            modes: ['code', 'text', 'tree', ],
            onChangeText: function (jsonString) {
            field.value = jsonString;
            }
        };

        // create the editor

        var editor = new JSONEditor(container, options, ${cstruct});
        })()
    </script>
</tal:def>